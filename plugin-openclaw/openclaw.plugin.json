{
  "id": "trustnet-openclaw",
  "name": "TrustNet Enforcement",
  "description": "TrustNet trust-to-act enforcement for OpenClaw with mode-based local-first runtime.",
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "mode": {
        "type": "string",
        "enum": [
          "local-lite",
          "local-verifiable"
        ],
        "description": "Execution mode. local-lite skips chain anchoring; local-verifiable enforces verify against RootRegistry.",
        "default": "local-lite"
      },
      "apiBaseUrl": {
        "type": "string",
        "description": "TrustNet API base URL. Optional in local-lite; required in local-verifiable compatibility mode."
      },
      "decider": {
        "type": "string",
        "description": "Decider principal identifier."
      },
      "targetPrincipalId": {
        "type": "string",
        "description": "Optional fixed target principal. If omitted, ctx.agentId is used."
      },
      "toolMapPath": {
        "type": "string",
        "description": "Path to deterministic tool->context mapping JSON."
      },
      "rpcUrl": {
        "type": "string",
        "description": "RPC endpoint for anchored verification in local-verifiable mode."
      },
      "rootRegistry": {
        "type": "string",
        "pattern": "^0x[a-fA-F0-9]{40}$",
        "description": "RootRegistry contract address used in local-verifiable mode."
      },
      "publisherAddress": {
        "type": "string",
        "pattern": "^0x[a-fA-F0-9]{40}$",
        "description": "Trusted root publisher address used in local-verifiable mode."
      },
      "policyManifestHash": {
        "type": "string",
        "pattern": "^0x[a-fA-F0-9]{64}$",
        "description": "Optional policy manifest hash attached to receipts."
      },
      "receiptSignerKeyHex": {
        "type": "string",
        "description": "Optional signer key passed to trustnet receipt."
      },
      "trustnetBinary": {
        "type": "string",
        "description": "Path to trustnet CLI binary. Defaults to trustnet on PATH."
      },
      "receiptOutDir": {
        "type": "string",
        "description": "Optional directory for persisted high-risk TrustNet local receipt JSON files."
      },
      "trustStorePath": {
        "type": "string",
        "description": "SQLite database path for local TrustNet tables (`edges_latest`, `receipts`, `agents`). Defaults to ./.trustnet/local-trust.db."
      },
      "trustCircles": {
        "type": "object",
        "additionalProperties": false,
        "description": "Trust circle policy preset controlling which endorsers count in local-lite mode.",
        "properties": {
          "default": {
            "type": "string",
            "enum": [
              "onlyMe",
              "myContacts",
              "openclawVerified",
              "custom"
            ],
            "default": "onlyMe"
          },
          "endorsers": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "myContacts": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "openclawVerified": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "custom": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "agentCards": {
        "type": "object",
        "additionalProperties": false,
        "description": "Agent Card verification policy for runtime imports.",
        "properties": {
          "trustedOwnerPubKeys": {
            "type": "array",
            "description": "Trusted Owner ed25519 public keys (base64 raw 32-byte keys). Imported cards signed by unknown owners are marked owner-unknown.",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "trustWorkflows": {
        "type": "object",
        "additionalProperties": false,
        "description": "Trust management workflow controls for trust/block/endorse confirmations.",
        "properties": {
          "confirmationTtlSeconds": {
            "type": "integer",
            "minimum": 30,
            "maximum": 86400,
            "description": "How long trust workflow confirmation tickets remain valid."
          }
        }
      },
      "requestTimeoutMs": {
        "type": "number",
        "minimum": 1
      },
      "verifyTimeoutMs": {
        "type": "number",
        "minimum": 1
      },
      "receiptTimeoutMs": {
        "type": "number",
        "minimum": 1
      },
      "askMode": {
        "type": "string",
        "enum": [
          "block",
          "allow"
        ],
        "description": "How ASK is handled in before_tool_call. In block mode, plugin returns trustnetAsk ticket metadata and expects retry with trustnetAskAction."
      },
      "unmappedDecision": {
        "type": "string",
        "enum": [
          "deny",
          "ask"
        ],
        "description": "Fallback for tools without mapping entries."
      },
      "failOpen": {
        "type": "boolean",
        "description": "If true, enforcement errors allow execution (not recommended)."
      }
    }
  },
  "uiHints": {
    "mode": {
      "label": "Mode",
      "help": "Use local-lite for chain-free runtime, local-verifiable to enforce RootRegistry verification."
    },
    "apiBaseUrl": {
      "label": "TrustNet API URL",
      "help": "Optional in local-lite. Required in local-verifiable mode."
    },
    "decider": {
      "label": "Decider",
      "help": "Principal used in TrustNet decision queries."
    },
    "toolMapPath": {
      "label": "Tool Map Path",
      "help": "Deterministic mapping JSON for OpenClaw tool names."
    },
    "rpcUrl": {
      "label": "RPC URL",
      "help": "Optional in local-lite. Required in local-verifiable mode."
    },
    "rootRegistry": {
      "label": "RootRegistry Address",
      "help": "Optional in local-lite. Required in local-verifiable mode."
    },
    "publisherAddress": {
      "label": "Publisher Address",
      "help": "Optional in local-lite. Required in local-verifiable mode."
    },
    "receiptOutDir": {
      "label": "Receipt Output Directory",
      "help": "If set, emitted high-risk TrustNet local receipts are persisted here."
    },
    "trustStorePath": {
      "label": "Trust Store Path",
      "help": "SQLite path for local edges/receipts/agents persistence."
    },
    "trustCircles": {
      "label": "Trust Circles",
      "help": "Select onlyMe/myContacts/openclawVerified/custom and provide corresponding endorser lists for local-lite."
    },
    "agentCards": {
      "label": "Agent Cards",
      "help": "Configure trusted owner public keys used when verifying runtime Agent Card imports."
    },
    "trustWorkflows": {
      "label": "Trust Workflows",
      "help": "Controls confirmation-ticket TTL for runtime trust/block/endorse workflow actions."
    },
    "failOpen": {
      "label": "Fail Open",
      "help": "Allow tool execution on TrustNet errors. Keep false for release."
    }
  }
}
